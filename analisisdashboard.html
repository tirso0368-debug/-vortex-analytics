<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>VORTEX | Análisis Personal</title>

<style>
body{
    margin:0;
    font-family: 'Segoe UI', sans-serif;
    background: linear-gradient(135deg,#0f172a,#1e293b);
    color:white;
}

.container{
    max-width:1100px;
    margin:auto;
    padding:40px 20px;
}

.card{
    background:rgba(255,255,255,0.05);
    padding:30px;
    border-radius:20px;
    backdrop-filter: blur(12px);
    box-shadow:0 10px 30px rgba(0,0,0,0.4);
    margin-bottom:30px;
}

h1{
    margin-bottom:10px;
    font-size:26px;
}

.stat{
    font-size:38px;
    font-weight:bold;
    margin:15px 0;
}

.btn{
    display:inline-block;
    padding:12px 25px;
    border-radius:10px;
    background:#6366f1;
    color:white;
    text-decoration:none;
    font-weight:600;
    transition:0.3s;
    cursor:pointer;
    border:none;
}

.btn:hover{
    background:#4f46e5;
}

.loader{
    position:fixed;
    top:0;
    left:0;
    width:100%;
    height:100%;
    background:#0f172a;
    display:flex;
    align-items:center;
    justify-content:center;
    font-size:20px;
    letter-spacing:1px;
}
</style>
</head>

<body>

<div id="loader" class="loader">
Procesando análisis avanzado...
</div>

<div class="container" style="display:none;" id="dashboard">

    <div class="card">
        <h1>Tu Perfil Cognitivo</h1>
        <div id="perfil" class="stat">Cargando...</div>
    </div>

    <div class="card">
        <h1>Nivel de Enfoque</h1>
        <div id="enfoque" class="stat">--%</div>
    </div>

    <div class="card">
        <h1>Estrategia Recomendada</h1>
        <p id="recomendacion">Generando estrategia personalizada...</p>
    </div>

    <button class="btn" id="logoutBtn">Cerrar sesión</button>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
import { getAuth, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
import { getFirestore, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";

const firebaseConfig = {
  apiKey: "AIzaSyCSa3xZ2iKtvnPaXeNQMluaoa27iiOEyeM",
  authDomain: "vortex-app-c8b00.firebaseapp.com",
  projectId: "vortex-app-c8b00",
  storageBucket: "vortex-app-c8b00.firebasestorage.app",
  messagingSenderId: "174144803653",
  appId: "1:174144803653:web:eeb421bd5770ee1f69a42c"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

onAuthStateChanged(auth, async (user)=>{
    if(!user){
        window.location.href="index.html";
        return;
    }

    const docRef = doc(db,"usuarios",user.uid);
    const docSnap = await getDoc(docRef);

    let perfil="Equilibrado";
    let enfoque=75;

    if(docSnap.exists()){
        const data = docSnap.data();
        perfil = data.perfil || perfil;
        enfoque = data.enfoque || enfoque;
    }

    document.getElementById("perfil").innerText = perfil;
    document.getElementById("enfoque").innerText = enfoque + "%";

    if(perfil==="Analítico"){
        document.getElementById("recomendacion").innerText =
        "Perfil estratégico y lógico. Prioriza planificación estructurada y sesiones profundas sin distracciones.";
    }
    else if(perfil==="Creativo"){
        document.getElementById("recomendacion").innerText =
        "Perfil creativo e innovador. Usa mapas mentales, colores y aprendizaje visual para maximizar rendimiento.";
    }
    else{
        document.getElementById("recomendacion").innerText =
        "Perfil equilibrado. Alterna estructura y creatividad para optimizar resultados.";
    }

    document.getElementById("loader").style.display="none";
    document.getElementById("dashboard").style.display="block";
});

document.getElementById("logoutBtn").addEventListener("click",()=>{
    signOut(auth).then(()=>{
        window.location.href="index.html";
    });
});
</script>

</body>
</html>
